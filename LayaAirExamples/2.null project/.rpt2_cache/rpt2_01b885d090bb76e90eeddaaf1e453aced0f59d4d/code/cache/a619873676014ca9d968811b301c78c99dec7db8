{
  "code": "export default class UIJoystick extends Laya.Script {\r\n    constructor() {\r\n        super();\r\n        this.isStart = false;\r\n        this.radius = 100;\r\n    }\r\n    initObject(obj) {\r\n        this.moveObj = obj;\r\n        return this;\r\n    }\r\n    initCamera(obj) {\r\n        this.mainCamera = obj;\r\n        return this;\r\n    }\r\n    onAwake() {\r\n        console.log('hello world');\r\n        this.btn = this.owner.getChildByName(\"JoystickBtn\");\r\n        let pos = new Laya.Point();\r\n        this.btn.transform.transformPoint(pos);\r\n        this.centerPos = this.btn.localToGlobal(new Laya.Point());\r\n        console.log(pos);\r\n        console.log(this.btn);\r\n        this.btn.on(Laya.Event.MOUSE_DOWN, this, this.mouseDown);\r\n        Laya.stage.on(Laya.Event.MOUSE_MOVE, this, this.mouseMove);\r\n        Laya.stage.on(Laya.Event.MOUSE_UP, this, this.mouseUp);\r\n    }\r\n    mouseDown(e) {\r\n        console.log(e);\r\n        this.isStart = true;\r\n    }\r\n    mouseMove(e) {\r\n        if (this.isStart) {\r\n            let pos = new Laya.Point(e.stageX, e.stageY);\r\n            this.setPos(pos);\r\n        }\r\n    }\r\n    mouseUp(e) {\r\n        console.log(e);\r\n        if (this.isStart) {\r\n            this.btn.centerX = 0;\r\n            this.btn.centerY = 0;\r\n            this.isStart = false;\r\n        }\r\n    }\r\n    setPos(pos) {\r\n        let a = (pos.y - this.btn.height / 2 - this.centerPos.y);\r\n        let b = (pos.x - this.btn.width / 2 - this.centerPos.x);\r\n        let des = Math.sqrt(Math.pow(b, 2) + Math.pow(a, 2));\r\n        if (des > this.radius) {\r\n            this.btn.centerX = (this.radius * b) / des;\r\n            this.btn.centerY = (this.radius * a) / des;\r\n        }\r\n        else {\r\n            this.btn.centerX = b;\r\n            this.btn.centerY = a;\r\n        }\r\n        let rb = this.moveObj.getComponent(Laya.Rigidbody3D);\r\n        let movePos = new Laya.Vector3(.2 * this.btn.centerX * -1 / 100, 0, 0.2 * this.btn.centerY * -1 / 100);\r\n        this.moveObj.transform.translate(movePos);\r\n        console.log(this.mainCamera.transform.position);\r\n        console.log(this.mainCamera.transform.localPosition);\r\n    }\r\n}\r\n",
  "references": []
}
